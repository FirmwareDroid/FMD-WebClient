{"ast":null,"code":"import _partial from 'lodash/partial';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\n\nimport React, { Component } from 'react';\nimport { renderAxes } from '../../../lib/canvas/axes';\nimport { getRelativeCursor, isCursorInRect } from '../../../lib/interactivity';\nimport { renderRect, renderCircle } from '../../../lib/canvas/charts/heatmap';\nimport { computeNodes } from '../../../lib/charts/heatmap';\nimport HeatMapCellTooltip from './HeatMapCellTooltip';\nimport Container from '../Container';\nimport { HeatMapPropTypes } from './props';\nimport enhance from './enhance';\n\nvar HeatMapCanvas = function (_Component) {\n  _inherits(HeatMapCanvas, _Component);\n\n  function HeatMapCanvas() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, HeatMapCanvas);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.handleMouseHover = function (showTooltip, hideTooltip, event) {\n      if (!_this.nodes) return;\n\n      var _getRelativeCursor = getRelativeCursor(_this.surface, event),\n          x = _getRelativeCursor[0],\n          y = _getRelativeCursor[1];\n\n      var _this$props = _this.props,\n          margin = _this$props.margin,\n          offsetX = _this$props.offsetX,\n          offsetY = _this$props.offsetY,\n          theme = _this$props.theme,\n          setCurrentNode = _this$props.setCurrentNode;\n\n      var node = _this.nodes.find(function (node) {\n        return isCursorInRect(node.x + margin.left + offsetX - node.width / 2, node.y + margin.top + offsetY - node.height / 2, node.width, node.height, x, y);\n      });\n\n      if (node !== undefined) {\n        setCurrentNode(node);\n        showTooltip(React.createElement(HeatMapCellTooltip, {\n          node: node,\n          theme: theme\n        }), event);\n      } else {\n        setCurrentNode(null);\n        hideTooltip();\n      }\n    }, _this.handleMouseLeave = function (hideTooltip) {\n      _this.props.setCurrentNode(null);\n\n      hideTooltip();\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  HeatMapCanvas.prototype.componentDidMount = function componentDidMount() {\n    this.ctx = this.surface.getContext('2d');\n    this.draw(this.props);\n  };\n\n  HeatMapCanvas.prototype.shouldComponentUpdate = function shouldComponentUpdate(props) {\n    if (this.props.outerWidth !== props.outerWidth || this.props.outerHeight !== props.outerHeight || this.props.isInteractive !== props.isInteractive || this.props.theme !== props.theme) {\n      return true;\n    } else {\n      this.draw(props);\n      return false;\n    }\n  };\n\n  HeatMapCanvas.prototype.componentDidUpdate = function componentDidUpdate() {\n    this.ctx = this.surface.getContext('2d');\n    this.draw(this.props);\n  };\n\n  HeatMapCanvas.prototype.draw = function draw(props) {\n    var width = props.width,\n        height = props.height,\n        outerWidth = props.outerWidth,\n        outerHeight = props.outerHeight,\n        pixelRatio = props.pixelRatio,\n        margin = props.margin,\n        offsetX = props.offsetX,\n        offsetY = props.offsetY,\n        xScale = props.xScale,\n        yScale = props.yScale,\n        cellShape = props.cellShape;\n    this.surface.width = outerWidth * pixelRatio;\n    this.surface.height = outerHeight * pixelRatio;\n    this.ctx.scale(pixelRatio, pixelRatio);\n    var renderNode = void 0;\n\n    if (cellShape === 'rect') {\n      renderNode = _partial(renderRect, this.ctx);\n    } else {\n      renderNode = _partial(renderCircle, this.ctx);\n    }\n\n    var nodes = computeNodes(props);\n    this.ctx.clearRect(0, 0, outerWidth, outerHeight);\n    this.ctx.translate(margin.left + offsetX, margin.top + offsetY);\n    renderAxes(this.ctx, {\n      xScale: xScale,\n      yScale: yScale,\n      width: width - offsetX * 2,\n      height: height - offsetY * 2,\n      top: props.axisTop,\n      right: props.axisRight,\n      bottom: props.axisBottom,\n      left: props.axisLeft\n    });\n    this.ctx.textAlign = 'center';\n    this.ctx.textBaseline = 'middle';\n    nodes.forEach(renderNode);\n    this.nodes = nodes;\n  };\n\n  HeatMapCanvas.prototype.render = function render() {\n    var _this2 = this;\n\n    var _props = this.props,\n        outerWidth = _props.outerWidth,\n        outerHeight = _props.outerHeight,\n        pixelRatio = _props.pixelRatio,\n        isInteractive = _props.isInteractive,\n        theme = _props.theme;\n    return React.createElement(Container, {\n      isInteractive: isInteractive,\n      theme: theme\n    }, function (_ref) {\n      var showTooltip = _ref.showTooltip,\n          hideTooltip = _ref.hideTooltip;\n      return React.createElement('canvas', {\n        ref: function ref(surface) {\n          _this2.surface = surface;\n        },\n        width: outerWidth * pixelRatio,\n        height: outerHeight * pixelRatio,\n        style: {\n          width: outerWidth,\n          height: outerHeight\n        },\n        onMouseEnter: _partial(_this2.handleMouseHover, showTooltip, hideTooltip),\n        onMouseMove: _partial(_this2.handleMouseHover, showTooltip, hideTooltip),\n        onMouseLeave: _partial(_this2.handleMouseLeave, hideTooltip)\n      });\n    });\n  };\n\n  return HeatMapCanvas;\n}(Component);\n\nHeatMapCanvas.propTypes = HeatMapPropTypes;\nexport default enhance(HeatMapCanvas);","map":{"version":3,"sources":["/Users/tom/Documents/MSE/zz_MasterThesis/06_FirmwareDroid/firmware-droid-client/node_modules/nivo/es/components/charts/heatmap/HeatMapCanvas.js"],"names":["_partial","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","React","Component","renderAxes","getRelativeCursor","isCursorInRect","renderRect","renderCircle","computeNodes","HeatMapCellTooltip","Container","HeatMapPropTypes","enhance","HeatMapCanvas","_Component","_temp","_this","_ret","_len","arguments","length","args","Array","_key","apply","concat","handleMouseHover","showTooltip","hideTooltip","event","nodes","_getRelativeCursor","surface","x","y","_this$props","props","margin","offsetX","offsetY","theme","setCurrentNode","node","find","left","width","top","height","undefined","createElement","handleMouseLeave","componentDidMount","ctx","getContext","draw","shouldComponentUpdate","outerWidth","outerHeight","isInteractive","componentDidUpdate","pixelRatio","xScale","yScale","cellShape","scale","renderNode","clearRect","translate","axisTop","right","axisRight","bottom","axisBottom","axisLeft","textAlign","textBaseline","forEach","render","_this2","_props","_ref","ref","style","onMouseEnter","onMouseMove","onMouseLeave","propTypes"],"mappings":"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","sourcesContent":["import _partial from 'lodash/partial';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport React, { Component } from 'react';\n\nimport { renderAxes } from '../../../lib/canvas/axes';\nimport { getRelativeCursor, isCursorInRect } from '../../../lib/interactivity';\nimport { renderRect, renderCircle } from '../../../lib/canvas/charts/heatmap';\nimport { computeNodes } from '../../../lib/charts/heatmap';\nimport HeatMapCellTooltip from './HeatMapCellTooltip';\nimport Container from '../Container';\nimport { HeatMapPropTypes } from './props';\nimport enhance from './enhance';\n\nvar HeatMapCanvas = function (_Component) {\n    _inherits(HeatMapCanvas, _Component);\n\n    function HeatMapCanvas() {\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, HeatMapCanvas);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.handleMouseHover = function (showTooltip, hideTooltip, event) {\n            if (!_this.nodes) return;\n\n            var _getRelativeCursor = getRelativeCursor(_this.surface, event),\n                x = _getRelativeCursor[0],\n                y = _getRelativeCursor[1];\n\n            var _this$props = _this.props,\n                margin = _this$props.margin,\n                offsetX = _this$props.offsetX,\n                offsetY = _this$props.offsetY,\n                theme = _this$props.theme,\n                setCurrentNode = _this$props.setCurrentNode;\n\n            var node = _this.nodes.find(function (node) {\n                return isCursorInRect(node.x + margin.left + offsetX - node.width / 2, node.y + margin.top + offsetY - node.height / 2, node.width, node.height, x, y);\n            });\n\n            if (node !== undefined) {\n                setCurrentNode(node);\n                showTooltip(React.createElement(HeatMapCellTooltip, { node: node, theme: theme }), event);\n            } else {\n                setCurrentNode(null);\n                hideTooltip();\n            }\n        }, _this.handleMouseLeave = function (hideTooltip) {\n            _this.props.setCurrentNode(null);\n            hideTooltip();\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    HeatMapCanvas.prototype.componentDidMount = function componentDidMount() {\n        this.ctx = this.surface.getContext('2d');\n        this.draw(this.props);\n    };\n\n    HeatMapCanvas.prototype.shouldComponentUpdate = function shouldComponentUpdate(props) {\n        if (this.props.outerWidth !== props.outerWidth || this.props.outerHeight !== props.outerHeight || this.props.isInteractive !== props.isInteractive || this.props.theme !== props.theme) {\n            return true;\n        } else {\n            this.draw(props);\n            return false;\n        }\n    };\n\n    HeatMapCanvas.prototype.componentDidUpdate = function componentDidUpdate() {\n        this.ctx = this.surface.getContext('2d');\n        this.draw(this.props);\n    };\n\n    HeatMapCanvas.prototype.draw = function draw(props) {\n        var width = props.width,\n            height = props.height,\n            outerWidth = props.outerWidth,\n            outerHeight = props.outerHeight,\n            pixelRatio = props.pixelRatio,\n            margin = props.margin,\n            offsetX = props.offsetX,\n            offsetY = props.offsetY,\n            xScale = props.xScale,\n            yScale = props.yScale,\n            cellShape = props.cellShape;\n\n\n        this.surface.width = outerWidth * pixelRatio;\n        this.surface.height = outerHeight * pixelRatio;\n\n        this.ctx.scale(pixelRatio, pixelRatio);\n\n        var renderNode = void 0;\n        if (cellShape === 'rect') {\n            renderNode = _partial(renderRect, this.ctx);\n        } else {\n            renderNode = _partial(renderCircle, this.ctx);\n        }\n\n        var nodes = computeNodes(props);\n\n        this.ctx.clearRect(0, 0, outerWidth, outerHeight);\n        this.ctx.translate(margin.left + offsetX, margin.top + offsetY);\n\n        renderAxes(this.ctx, {\n            xScale: xScale,\n            yScale: yScale,\n            width: width - offsetX * 2,\n            height: height - offsetY * 2,\n            top: props.axisTop,\n            right: props.axisRight,\n            bottom: props.axisBottom,\n            left: props.axisLeft\n        });\n\n        this.ctx.textAlign = 'center';\n        this.ctx.textBaseline = 'middle';\n\n        nodes.forEach(renderNode);\n\n        this.nodes = nodes;\n    };\n\n    HeatMapCanvas.prototype.render = function render() {\n        var _this2 = this;\n\n        var _props = this.props,\n            outerWidth = _props.outerWidth,\n            outerHeight = _props.outerHeight,\n            pixelRatio = _props.pixelRatio,\n            isInteractive = _props.isInteractive,\n            theme = _props.theme;\n\n\n        return React.createElement(\n            Container,\n            { isInteractive: isInteractive, theme: theme },\n            function (_ref) {\n                var showTooltip = _ref.showTooltip,\n                    hideTooltip = _ref.hideTooltip;\n                return React.createElement('canvas', {\n                    ref: function ref(surface) {\n                        _this2.surface = surface;\n                    },\n                    width: outerWidth * pixelRatio,\n                    height: outerHeight * pixelRatio,\n                    style: {\n                        width: outerWidth,\n                        height: outerHeight\n                    },\n                    onMouseEnter: _partial(_this2.handleMouseHover, showTooltip, hideTooltip),\n                    onMouseMove: _partial(_this2.handleMouseHover, showTooltip, hideTooltip),\n                    onMouseLeave: _partial(_this2.handleMouseLeave, hideTooltip)\n                });\n            }\n        );\n    };\n\n    return HeatMapCanvas;\n}(Component);\n\nHeatMapCanvas.propTypes = HeatMapPropTypes;\n\nexport default enhance(HeatMapCanvas);"]},"metadata":{},"sourceType":"module"}