{"ast":null,"code":"import _cloneDeep from 'lodash/cloneDeep';\nimport _sortBy from 'lodash/sortBy';\n/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Motion, TransitionMotion, spring } from 'react-motion';\nimport compose from 'recompose/compose';\nimport defaultProps from 'recompose/defaultProps';\nimport withPropsOnChange from 'recompose/withPropsOnChange';\nimport withProps from 'recompose/withProps';\nimport pure from 'recompose/pure';\nimport { partition as Partition, hierarchy } from 'd3-hierarchy';\nimport { arc } from 'd3-shape';\nimport { getInheritedColorGenerator } from '../../../lib/colors';\nimport { withTheme, withDimensions, withColors } from '../../../hocs';\nimport { getAccessorFor } from '../../../lib/propertiesConverters';\nimport Container from '../Container';\nimport SvgWrapper from '../SvgWrapper';\nimport SunburstArc from './SunburstArc';\n\nvar getAncestor = function getAncestor(node) {\n  if (node.depth === 1) return node;\n  if (node.parent) return getAncestor(node.parent);\n  return node;\n};\n\nvar Sunburst = function Sunburst(_ref) {\n  var nodes = _ref.nodes,\n      margin = _ref.margin,\n      centerX = _ref.centerX,\n      centerY = _ref.centerY,\n      outerWidth = _ref.outerWidth,\n      outerHeight = _ref.outerHeight,\n      arcGenerator = _ref.arcGenerator,\n      borderWidth = _ref.borderWidth,\n      borderColor = _ref.borderColor,\n      theme = _ref.theme,\n      isInteractive = _ref.isInteractive;\n  return React.createElement(Container, {\n    isInteractive: isInteractive,\n    theme: theme\n  }, function (_ref2) {\n    var showTooltip = _ref2.showTooltip,\n        hideTooltip = _ref2.hideTooltip;\n    return React.createElement(SvgWrapper, {\n      width: outerWidth,\n      height: outerHeight,\n      margin: margin\n    }, React.createElement('g', {\n      transform: 'translate(' + centerX + ', ' + centerY + ')'\n    }, nodes.filter(function (node) {\n      return node.depth > 0;\n    }).map(function (node, i) {\n      return React.createElement(SunburstArc, {\n        key: i,\n        node: node,\n        arcGenerator: arcGenerator,\n        borderWidth: borderWidth,\n        borderColor: borderColor,\n        showTooltip: showTooltip,\n        hideTooltip: hideTooltip,\n        theme: theme\n      });\n    })));\n  });\n};\n\nSunburst.propTypes = {\n  data: PropTypes.object.isRequired,\n  identity: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n  getIdentity: PropTypes.func.isRequired,\n  // computed\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n  getValue: PropTypes.func.isRequired,\n  // computed\n  nodes: PropTypes.array.isRequired,\n  // computed\n  partition: PropTypes.func.isRequired,\n  // computed\n  cornerRadius: PropTypes.number.isRequired,\n  arcGenerator: PropTypes.func.isRequired,\n  // computed\n  radius: PropTypes.number.isRequired,\n  // computed\n  centerX: PropTypes.number.isRequired,\n  // computed\n  centerY: PropTypes.number.isRequired,\n  // computed\n  // border\n  borderWidth: PropTypes.number.isRequired,\n  borderColor: PropTypes.string.isRequired,\n  childColor: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n  // interactivity\n  isInteractive: PropTypes.bool\n};\nexport var SunburstDefaultProps = {\n  identity: 'id',\n  value: 'value',\n  cornerRadius: 0,\n  // border\n  borderWidth: 1,\n  borderColor: 'white',\n  childColor: 'inherit',\n  // interactivity\n  isInteractive: true\n};\nvar enhance = compose(defaultProps(SunburstDefaultProps), withTheme(), withDimensions(), withColors(), withProps(function (_ref3) {\n  var width = _ref3.width,\n      height = _ref3.height;\n  var radius = Math.min(width, height) / 2;\n  var partition = Partition().size([2 * Math.PI, radius * radius]);\n  return {\n    radius: radius,\n    partition: partition,\n    centerX: width / 2,\n    centerY: height / 2\n  };\n}), withPropsOnChange(['cornerRadius'], function (_ref4) {\n  var cornerRadius = _ref4.cornerRadius;\n  return {\n    arcGenerator: arc().startAngle(function (d) {\n      return d.x0;\n    }).endAngle(function (d) {\n      return d.x1;\n    }).innerRadius(function (d) {\n      return Math.sqrt(d.y0);\n    }).outerRadius(function (d) {\n      return Math.sqrt(d.y1);\n    }).cornerRadius(cornerRadius)\n  };\n}), withPropsOnChange(['identity'], function (_ref5) {\n  var identity = _ref5.identity;\n  return {\n    getIdentity: getAccessorFor(identity)\n  };\n}), withPropsOnChange(['value'], function (_ref6) {\n  var value = _ref6.value;\n  return {\n    getValue: getAccessorFor(value)\n  };\n}), withPropsOnChange(['data', 'getValue'], function (_ref7) {\n  var data = _ref7.data,\n      getValue = _ref7.getValue;\n  return {\n    data: hierarchy(data).sum(getValue)\n  };\n}), withPropsOnChange(['childColor'], function (_ref8) {\n  var childColor = _ref8.childColor;\n  return {\n    getChildColor: getInheritedColorGenerator(childColor)\n  };\n}), withPropsOnChange(['data', 'partition', 'getIdentity', 'getChildColor'], function (_ref9) {\n  var data = _ref9.data,\n      partition = _ref9.partition,\n      getIdentity = _ref9.getIdentity,\n      getColor = _ref9.getColor,\n      getChildColor = _ref9.getChildColor;\n  var total = data.value;\n\n  var nodes = _sortBy(partition(_cloneDeep(data)).descendants(), 'depth');\n\n  nodes.forEach(function (node) {\n    var ancestor = getAncestor(node).data;\n    delete node.children;\n    delete node.data.children;\n    Object.assign(node.data, {\n      id: getIdentity(node.data),\n      value: node.value,\n      percentage: 100 * node.value / total,\n      depth: node.depth,\n      ancestor: ancestor\n    });\n\n    if (node.depth === 1) {\n      node.data.color = getColor(node.data);\n    } else if (node.depth > 1) {\n      node.data.color = getChildColor(node.parent.data);\n    }\n  });\n  return {\n    nodes: nodes\n  };\n}), pure);\nvar enhancedSunburst = enhance(Sunburst);\nenhancedSunburst.displayName = 'enhance(Sunburst)';\nexport default enhancedSunburst;","map":{"version":3,"sources":["/Users/tom/Documents/MSE/zz_MasterThesis/06_FirmwareDroid/firmware-droid-client/node_modules/nivo/es/components/charts/sunburst/Sunburst.js"],"names":["_cloneDeep","_sortBy","React","PropTypes","Motion","TransitionMotion","spring","compose","defaultProps","withPropsOnChange","withProps","pure","partition","Partition","hierarchy","arc","getInheritedColorGenerator","withTheme","withDimensions","withColors","getAccessorFor","Container","SvgWrapper","SunburstArc","getAncestor","node","depth","parent","Sunburst","_ref","nodes","margin","centerX","centerY","outerWidth","outerHeight","arcGenerator","borderWidth","borderColor","theme","isInteractive","createElement","_ref2","showTooltip","hideTooltip","width","height","transform","filter","map","i","key","propTypes","data","object","isRequired","identity","oneOfType","string","func","getIdentity","value","getValue","array","cornerRadius","number","radius","childColor","bool","SunburstDefaultProps","enhance","_ref3","Math","min","size","PI","_ref4","startAngle","d","x0","endAngle","x1","innerRadius","sqrt","y0","outerRadius","y1","_ref5","_ref6","_ref7","sum","_ref8","getChildColor","_ref9","getColor","total","descendants","forEach","ancestor","children","Object","assign","id","percentage","color","enhancedSunburst","displayName"],"mappings":"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","sourcesContent":["import _cloneDeep from 'lodash/cloneDeep';\nimport _sortBy from 'lodash/sortBy';\n/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Motion, TransitionMotion, spring } from 'react-motion';\nimport compose from 'recompose/compose';\nimport defaultProps from 'recompose/defaultProps';\nimport withPropsOnChange from 'recompose/withPropsOnChange';\nimport withProps from 'recompose/withProps';\nimport pure from 'recompose/pure';\nimport { partition as Partition, hierarchy } from 'd3-hierarchy';\nimport { arc } from 'd3-shape';\nimport { getInheritedColorGenerator } from '../../../lib/colors';\nimport { withTheme, withDimensions, withColors } from '../../../hocs';\nimport { getAccessorFor } from '../../../lib/propertiesConverters';\nimport Container from '../Container';\nimport SvgWrapper from '../SvgWrapper';\nimport SunburstArc from './SunburstArc';\n\nvar getAncestor = function getAncestor(node) {\n    if (node.depth === 1) return node;\n    if (node.parent) return getAncestor(node.parent);\n    return node;\n};\n\nvar Sunburst = function Sunburst(_ref) {\n    var nodes = _ref.nodes,\n        margin = _ref.margin,\n        centerX = _ref.centerX,\n        centerY = _ref.centerY,\n        outerWidth = _ref.outerWidth,\n        outerHeight = _ref.outerHeight,\n        arcGenerator = _ref.arcGenerator,\n        borderWidth = _ref.borderWidth,\n        borderColor = _ref.borderColor,\n        theme = _ref.theme,\n        isInteractive = _ref.isInteractive;\n\n    return React.createElement(\n        Container,\n        { isInteractive: isInteractive, theme: theme },\n        function (_ref2) {\n            var showTooltip = _ref2.showTooltip,\n                hideTooltip = _ref2.hideTooltip;\n            return React.createElement(\n                SvgWrapper,\n                { width: outerWidth, height: outerHeight, margin: margin },\n                React.createElement(\n                    'g',\n                    { transform: 'translate(' + centerX + ', ' + centerY + ')' },\n                    nodes.filter(function (node) {\n                        return node.depth > 0;\n                    }).map(function (node, i) {\n                        return React.createElement(SunburstArc, {\n                            key: i,\n                            node: node,\n                            arcGenerator: arcGenerator,\n                            borderWidth: borderWidth,\n                            borderColor: borderColor,\n                            showTooltip: showTooltip,\n                            hideTooltip: hideTooltip,\n                            theme: theme\n                        });\n                    })\n                )\n            );\n        }\n    );\n};\n\nSunburst.propTypes = {\n    data: PropTypes.object.isRequired,\n    identity: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n    getIdentity: PropTypes.func.isRequired, // computed\n    value: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n    getValue: PropTypes.func.isRequired, // computed\n    nodes: PropTypes.array.isRequired, // computed\n\n    partition: PropTypes.func.isRequired, // computed\n\n    cornerRadius: PropTypes.number.isRequired,\n    arcGenerator: PropTypes.func.isRequired, // computed\n\n    radius: PropTypes.number.isRequired, // computed\n    centerX: PropTypes.number.isRequired, // computed\n    centerY: PropTypes.number.isRequired, // computed\n\n    // border\n    borderWidth: PropTypes.number.isRequired,\n    borderColor: PropTypes.string.isRequired,\n\n    childColor: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n\n    // interactivity\n    isInteractive: PropTypes.bool\n};\n\nexport var SunburstDefaultProps = {\n    identity: 'id',\n    value: 'value',\n\n    cornerRadius: 0,\n\n    // border\n    borderWidth: 1,\n    borderColor: 'white',\n\n    childColor: 'inherit',\n\n    // interactivity\n    isInteractive: true\n};\n\nvar enhance = compose(defaultProps(SunburstDefaultProps), withTheme(), withDimensions(), withColors(), withProps(function (_ref3) {\n    var width = _ref3.width,\n        height = _ref3.height;\n\n    var radius = Math.min(width, height) / 2;\n\n    var partition = Partition().size([2 * Math.PI, radius * radius]);\n\n    return { radius: radius, partition: partition, centerX: width / 2, centerY: height / 2 };\n}), withPropsOnChange(['cornerRadius'], function (_ref4) {\n    var cornerRadius = _ref4.cornerRadius;\n    return {\n        arcGenerator: arc().startAngle(function (d) {\n            return d.x0;\n        }).endAngle(function (d) {\n            return d.x1;\n        }).innerRadius(function (d) {\n            return Math.sqrt(d.y0);\n        }).outerRadius(function (d) {\n            return Math.sqrt(d.y1);\n        }).cornerRadius(cornerRadius)\n    };\n}), withPropsOnChange(['identity'], function (_ref5) {\n    var identity = _ref5.identity;\n    return {\n        getIdentity: getAccessorFor(identity)\n    };\n}), withPropsOnChange(['value'], function (_ref6) {\n    var value = _ref6.value;\n    return {\n        getValue: getAccessorFor(value)\n    };\n}), withPropsOnChange(['data', 'getValue'], function (_ref7) {\n    var data = _ref7.data,\n        getValue = _ref7.getValue;\n    return {\n        data: hierarchy(data).sum(getValue)\n    };\n}), withPropsOnChange(['childColor'], function (_ref8) {\n    var childColor = _ref8.childColor;\n    return {\n        getChildColor: getInheritedColorGenerator(childColor)\n    };\n}), withPropsOnChange(['data', 'partition', 'getIdentity', 'getChildColor'], function (_ref9) {\n    var data = _ref9.data,\n        partition = _ref9.partition,\n        getIdentity = _ref9.getIdentity,\n        getColor = _ref9.getColor,\n        getChildColor = _ref9.getChildColor;\n\n    var total = data.value;\n\n    var nodes = _sortBy(partition(_cloneDeep(data)).descendants(), 'depth');\n    nodes.forEach(function (node) {\n        var ancestor = getAncestor(node).data;\n\n        delete node.children;\n        delete node.data.children;\n\n        Object.assign(node.data, {\n            id: getIdentity(node.data),\n            value: node.value,\n            percentage: 100 * node.value / total,\n            depth: node.depth,\n            ancestor: ancestor\n        });\n\n        if (node.depth === 1) {\n            node.data.color = getColor(node.data);\n        } else if (node.depth > 1) {\n            node.data.color = getChildColor(node.parent.data);\n        }\n    });\n\n    return { nodes: nodes };\n}), pure);\n\nvar enhancedSunburst = enhance(Sunburst);\nenhancedSunburst.displayName = 'enhance(Sunburst)';\n\nexport default enhancedSunburst;"]},"metadata":{},"sourceType":"module"}